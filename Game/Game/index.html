<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title>SpriteGame Development</title>
    <script src="js/jquery-2.1.0.min.js"></script>
    <script src="gameHandler.js"></script>
    <script src="renderer.js"></script>
    <script src="eventHandler.js"></script>
    <script src="animationHandler.js"></script>
    <script src="playerManager.js"></script>
    <script src="windowManager.js"></script>
    <script src="scriptHandler.js"></script>
    <script src="NPCHandler.js"></script>
    <script src="MultiplayerHandler.js"></script>
    <script src="Profiler.js"></script>
</head>
<body>
    <div class="output"></div>

    <canvas id="canvas"></canvas>

    <audio controls id="themeSound">
        <source src="sound/theme.mp3" type="audio/mpeg">
        Your browser does not support the audio element.
    </audio>

    <script>

        var gameHandler = new GameHandler({
            verbose: false,
            initStaticAnimations: true,
            mapPath: "data/lake2.json",
            width: 600,
            height: 400
        });
        var eventHandler = new EventHandler(gameHandler);
        var render = new Renderer($("#canvas")[0], gameHandler);
        gameHandler.setRenderer(render);

        var profiler = new Profiler(gameHandler);

        gameHandler.init();

        var script = new ScriptHandler(gameHandler);
        var mp = null;


        eventHandler.addEventListener("postInit", function ()
        {
            script.loadScript("data/scripts/test.json");
        });

        eventHandler.addEventListener("npcInit", function ()
        {
            //gameHandler.npcManager.addNPC("test", { X: 24, Y: 10 }, "pichu", "stand");
        });


    </script>

    <p>Use Cursor Keys to move.</p>

    <button id="connect">Connect to Multiplayer Server (WIP)</button>

    <script>
        $(document).ready(function ()
        {
            $("#connect").click(function ()
            {
                var person = prompt("Please enter your name", "Guest" + Math.round(Math.random() * 1000));

                if (person != null)
                {

                    mp = new MultiplayerHandler(gameHandler, "ws://server.mrh-development.de:8181", person);
                    //mp = new MultiplayerHandler(gameHandler, "ws://localhost:8181", person);
                    mp.connect();

                    $(this).before("<p>Connected</p>").remove();
                }

            });


        });

    </script>


</body>
</html>